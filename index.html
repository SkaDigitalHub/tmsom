<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0 maximum-scale=1.0, user-scalable=no" />
    <title>The Mandate School of Ministry</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="logo/main.png" type="image/png">
    <link rel="apple-touch-icon" href="logo/main.png">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
</head>
<body>
    <div class="logo-container">
        <div class="logo"><img src="logo/main.png" alt="TMSOM Logo" style="width:100%; border-radius:50%;"></div>
        <h1 class="school-name">THE MANDATE SCHOOL OF MINISTRY (TMSOM)</h1>
        <p class="description">This is a 6-month intensive school of ministry</p>
    </div>
    
    <div class="buttons">
        <button class="btn btn-login" onclick="window.location.replace('login.html')">LOG IN</button>
        <button class="btn btn-register" onclick="window.location.replace('register.html')">REGISTER</button>
        <button class="btn btn-learn" onclick="window.location.replace('agent.html', '_self')">LEARN MORE</button>
    </div>

    <!-- Dark Mode Toggle Button -->
  <button class="mode-toggle" onclick="toggleMode()">ðŸŒ™</button>


<!-- Notification btn-->
<button id="enable-notifications">Enable Notifications</button>

<!-- Notification Toast -->    
<div id="sync-toast" style="...">
  <span id="sync-message"></span>
  <button onclick="location.reload()">Refresh</button>
</div>

<!-- Offline Indicator -->
<div id="offline-bar" style="display:none; background:red; color:white;">
  Offline - Changes will sync when connected
</div>
    
    <script>
// Register Service Worker with enhanced error handling
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/tmsom/sw.js', { 
      scope: '/tmsom/' 
    })
    .then(reg => {
      console.log('[SW] Registration successful. Scope:', reg.scope);
      
      // Optional: Check for updates on page load
      reg.update().then(() => {
        if (reg.installing) {
          console.log('[SW] Update found and installing...');
          reg.installing.addEventListener('statechange', () => {
            if (reg.installing.state === 'activated') {
              console.log('[SW] New version activated!');
              // Notify user or reload (optional)
              window.location.reload();
            }
          });
        }
      });
    })
    .catch(err => {
      console.error('[SW] Registration failed:', err);
      // Fallback: Show a warning to the user (optional)
      document.body.insertAdjacentHTML(
        'beforeend',
        '<div class="sw-error">Offline features disabled. Check network.</div>'
      );
    });
  });
} else {
  console.warn('[SW] Service Worker not supported in this browser.');
  // Fallback for non-SW browsers (e.g., display a message)
}
</script>

    <script src="script.js"></script>
</body>
</html>
